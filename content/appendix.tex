\subsection{Extended UAV dynamics}

General form of Euler-Lagrange dynamics for a rotating rigid body in SE(3) configuration manifold in the body-fixed frame:
\begin{gather}
	\frac{d}{dt} \left( \frac{\partial \La}{\partial \omega} \right)
	+ \omega \times \frac{\partial \La}{\partial \omega} 
	+ v \times \frac{\partial \La}{\partial v} 
	+ \sum_{i=1}^{3} r_i \times \frac{\partial \La}{\partial r_i} = 0 \label{general1}\\
	\frac{d}{dt} \left( \frac{\partial \La}{\partial v} \right)
	+ \omega \times \frac{\partial \La}{\partial v} 
	- R^T \frac{\partial \La}{\partial x} = 0 \label{general2}
\end{gather}

For the the proposed UAS with variations in center of mass the Lagrangian is:
\begin{equation}
	\La(R,x,\Omega,v) = \frac{1}{2}\omega^TJ\omega + m \omega^T S(r_{cm})v + \frac{1}{2}mv^Tv - U(R,x)
\end{equation}

\noindent where $U(R,x)$ is the potential energy of the system. It is important to note that $J$ and $r_{cm}$ are changing over time. \\
Lagrangian derivatives needed for the general form equation are:

\begin{gather}
	\frac{\partial \La}{\partial \omega} = J\omega + m S(r_{cm})v \label{d1}\\ 
	\frac{d}{dt} \left( \frac{\partial \La}{\partial \omega} \right) = \dot{J} \omega + J \dot{\omega} + m \dot{r}_{cm} \times v + m r_{cm} \times \dot{v} \label{d2}\\ 
	\frac{\partial \La}{\partial v} = mv - mr_{cm} \times \omega \label{d3}\\ 
	\frac{d}{dt} \left( \frac{\partial \La}{\partial v} \right) = m\dot{v} - m\dot{r}_{cm} \times \omega - m r_{cm} \times \dot{\omega} \label{d4}
\end{gather}

It is of interest to transfer rotation and translation dynamics in the inertial frame. This can be done using the following relations:

\begin{gather}
	v = R^T \dot{x} \label{inertial1}\\
	\dot{v} = R^T \ddot{x} - \omega \times (R^T \dot{x} ) \label{inertial2} \\
	r_{cm} = R^T(x_{cm} - x) \label{inertial3} \\
	\dot{r}_{cm} = R^T(\dot{x}_{cm} - \dot{x}) + R^TS(\omega)x_{cm} - S(\omega)R^T(x_{cm} - x) \label{inertial4}
\end{gather}

After plugging in \ref{d1}, \ref{d2}, \ref{d3}, \ref{d4} in \ref{general1}, \ref{general2} and using \ref{inertial1}, \ref{inertial2} as transformations of velocity and acceleration to inertial frame the following equations are obtained:
\begin{align}
	\begin{split}
		& J\dot{\omega} + m r_{cm} \times R^T \ddot{x} \\
		&+ \dot{J} \omega + m\dot{r}_{cm} \times R^T \dot{x} \\
		&+ \omega \times J\omega + \sum_{i=1}^{3} r_i \times \frac{\partial \La}{\partial r_i} = 0
	\end{split}
\end{align}
\begin{align}
	\begin{split}
		& m\ddot{x} - mRS(r_{cm}) \dot{\omega} - mRS(\dot{r}_{cm})\omega\\
		&-mRS(\omega)S(r_{cm})\omega + \frac{\partial U}{\partial x} = 0
	\end{split}
\end{align}

After plugging in the center of mass transform \ref{inertial3}, \ref{inertial4} the final form of dynamics is obtained:
\begin{align}
	\begin{split}
		 & J\dot{\omega} + mR^T(x_{cm} - x) \times R^T\ddot{x} + \dot{J}\omega \\
		 & + mS(R^T\dot{x}_{cm})R^T\dot{x} - R^T\dot{x} \times (R^TS(\omega)x_{cm}) \\
		 & - mS(\omega)R^T(x_{cm} - x) \times R^T \dot{x} \\
		 & + \omega \times J\omega  + \sum_{i=1}^{3} r_i \times \frac{\partial \La}{\partial r_i} = 0
	\end{split}
\end{align}
\begin{align}
	\begin{split}
		m \ddot{x} &- mRS(R^T(x_{cm} - x))\dot{\omega} \\
		& - mRS(R^T(\dot{x}_{cm} - \dot{x})) \omega \\
		& - mR[(R^TS(\omega)x_{cm}) \times \omega] \\
		& + \frac{\partial U}{\partial x} = 0
	\end{split}
\end{align}
