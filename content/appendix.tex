In this section rotating body dynamics with variations in center of gravity is derived.
General form of Euler-Lagrange dynamics for a rotating rigid body on SE(3) configuration manifold in the body-fixed frame as presented in \cite{LeeModel}:

\begin{gather}
	\frac{d}{dt} \left( \frac{\partial \La}{\partial \mb{\Omega}} \right)
	+ \mb{\Omega} \times \frac{\partial \La}{\partial \mb{\Omega}} 
	+ \textbf{v} \times \frac{\partial \La}{\partial \textbf{v}} 
	+ \sum_{i=1}^{3} \textbf{r}_i \times \frac{\partial \La}{\partial \textbf{r}_i} = 0 \label{general1}\\
	\frac{d}{dt} \left( \frac{\partial \La}{\partial \textbf{v}} \right)
	+ \mb{\Omega} \times \frac{\partial \La}{\partial \textbf{v}} 
	- \text{R}^T \frac{\partial \La}{\partial x} = 0 \label{general2}
\end{gather}
For the proposed UAV with variations in CoG the Lagrangian is:

\begin{gather}
\begin{align}
\begin{split}
	\La(\text{R},x,\mb{\Omega},\textbf{v}) &= \frac{1}{2}\mb{\Omega}^T\text{J}\mb{\Omega} \,+\, m \mb{\Omega}^T \reallywidehat{\textbf{r}}_{CoG}\textbf{v} \\
	\, &+\, \frac{1}{2}m\textbf{v}^T\textbf{v} \,-\, U(\text{R},\textbf{x}) \, ,
\end{split}
\end{align}
\end{gather}
where $U(\text{R}, \textbf{x})$ is the potential energy. It is important to note that \text{J} and $\textbf{r}_{CoG}$ are variable over time. \\
%Lagrangian derivatives needed for the general form equations \ref{general1} and \ref{general2} are:
%\begin{gather}
%	\frac{\partial \La}{\partial \mb{\Omega}} = \text{J}\mb{\Omega} + m \reallywidehat{\textbf{r}}_{CoG}\textbf{v} \label{d1}\\ 
%	\frac{d}{dt} \left( \frac{\partial \La}{\partial \mb{\Omega}} \right) = \dot{\text{J}} \mb{\Omega} + \text{J} \dot{\mb{\Omega}} + m \dot{\textbf{r}}_{CoG} \times \textbf{v} + m \textbf{r}_{CoG} \times \dot{\textbf{v}} \label{d2}\\ 
%	\frac{\partial \La}{\partial \textbf{v}} = m\textbf{v} - m\textbf{r}_{CoG} \times \mb{\Omega} \label{d3}\\ 
%	\frac{d}{dt} \left( \frac{\partial \La}{\partial \textbf{v}} \right) = m\dot{\textbf{v}} - m\dot{\textbf{r}}_{CoG} \times \mb{\Omega} - m \textbf{r}_{CoG} \times \dot{\mb{\Omega}} \label{d4}
%\end{gather}
It is of interest to transfer rotation and translation dynamics in the inertial frame. This can be done using the following relations:
\begin{gather}
	\textbf{v} = \text{R}^T \dot{x} \label{inertial1}\\
	\dot{\textbf{v}} = \text{R}^T \ddot{\textbf{x}} - \mb{\Omega} \times (\, \text{R}^T \dot{\textbf{x}} \,) \label{inertial2} \\
	\textbf{r}_{CoG} = \text{R}^T(\, \textbf{x}_{CoG} - \textbf{x} \,) \label{inertial3} \\
	\dot{\textbf{r}}_{CoG} = \text{R}^T(\, \dot{\textbf{x}}_{CoG} - \dot{\textbf{x}} \,) - \reallywidehat{\mb{\Omega}}\text{R}^T(\, \textbf{x}_{CoG} - \textbf{x} \,) \label{inertial4}
\end{gather}
After computing Lagrangian derivatives, plugging them in \ref{general1}, \ref{general2} and using \ref{inertial1}, \ref{inertial2} as velocity and acceleration transformations to the inertial frame the following equations are obtained:
\begin{gather}
\label{complete_model1}
\begin{align}
	\begin{split}
		\text{J}\dot{\mb{\Omega}} &+ m \textbf{r}_{CoG} \times \text{R}^T \ddot{\textbf{x}} + \mb{\Omega} \times \text{J}\mb{\Omega} \\
		&+ \dot{\text{J}} \mb{\Omega} + m \dot{\textbf{r}}_{CoG} \times \text{R}^T \dot{\textbf{x}} + \sum_{i=1}^{3} \textbf{r}_i \times \frac{\partial \La}{\partial \textbf{r}_i} = 0
	\end{split}
\end{align}
\end{gather}
\begin{gather}
\label{complete_model2}
\begin{align}
	\begin{split}
		m \ddot{\textbf{x}} & - m \text{R} \,(\, \textbf{r}_{CoG} \times \dot{\mb{\Omega}} \,) - m \text{R} \,[\, \mb{\Omega} \times (\, \textbf{r}_{CoG} \times \mb{\Omega} \,) \,] \\
		&- m \text{R} \,(\, \dot{\textbf{r}}_{CoG} \times \mb{\Omega} \,) + \frac{\partial U(\text{R},\textbf{x})}{\partial \textbf{x}} = 0
	\end{split}
\end{align}
\end{gather}
Finally, CoG transforms \ref{inertial3} and \ref{inertial4} are included along with forces and moments acting in the body-fixed frame which gives the following model dynamics:
\begin{gather}
\begin{align}
	\begin{split}
		 \text{J}\dot{\mb{\Omega}} & + m \textbf{r}_{CoG} \times \text{R}^T\ddot{\textbf{x}} + \mb{\Omega} \times \text{J}\mb{\Omega}  \\
		 & - m (\, \mb{\Omega} \times \textbf{r}_{CoG} \,) \times \text{R}^T \dot{\textbf{x}} \\
		 & + \dot{\text{J}}\mb{\Omega} + m \, \reallywidehat{R^T (\, \dot{\textbf{x}}_{CoG} - \dot{\textbf{x}} \,)} \, R^T\dot{\textbf{x}} = \textbf{M}
	\end{split}
\end{align}
\end{gather}
\begin{gather}
\begin{align}
	\begin{split}
		m \ddot{\textbf{x}} & - m \text{R} \,(\, \textbf{r}_{CoG} \times \dot{\mb{\Omega}} \,) + m g\textbf{e}_3 \\
		& - m \text{R} \, \reallywidehat{ \text{R}^T (\, \dot{\textbf{x}}_{CoG} - \dot{\textbf{x}} \,) } \, \mb{\Omega}  = f\text{R}\textbf{e}_3
	\end{split}
\end{align}
\end{gather}
\noindent Please note that \textit{wide hat} is the same operator previously defined in \eqref{eqn:hat}.